<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">

<dom-module id="my-view1">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
        
      }

      h1, h2, h3, .text{
        text-align: center;
      }

      .countdown{
        padding-top: 30px;
        font-size: 1.2rem;
      }
    </style>

    <div class="card">
      <h1>{{calcString("hometitolo1", langPath, lingua)}}</h1>
      <h2>{{calcString("hometitolo2", langPath, lingua)}}</h2>
      <h2>{{calcString("hometitolo3", langPath, lingua)}}</h2>

      <div class="text">{{calcString("homecont1", langPath, lingua)}}</div>
      <div class="text">{{calcString("homecont2", langPath, lingua)}}</div>


        <div class="text countdown">
        {{countDown(trigger)}}
        </div>
    </div>
  </template>

  <script>
    Polymer({
      is: 'my-view1',

       properties: {
          trigger: {type: String, value: "asd",notify: true}
        },

      calcString: function(campo, path, lingua){

        if(this.lingua[path][campo] == null)
          return "<no string>"

        return this.lingua[path][campo];
      },

      countDown: function(momento){

        setInterval(function(){    
          this.trigger = moment(); 
        
        }.bind(this), 1000);

        var weddingDate = moment('2017-09-23 13:00:00');
        var now = moment();

        var monthNow = now.format('M');
        var dayNow = now.format('D');
        var hourNow = now.format('H');
        var minuteNow = now.format('m');
        var secondsNow = now.format('s');

        var diffMonths = weddingDate.format('M') - monthNow;
        var diffDays = weddingDate.format('D') - dayNow;
        var diffHours = weddingDate.format('H') - hourNow;
        var diffMinutes = weddingDate.format('m') - minuteNow;
        var diffSeconds = weddingDate.format('s') - secondsNow;

        if(diffSeconds < 0){
          diffSeconds = 60 + diffSeconds;
          diffMinutes--;
        }

        if(diffMinutes < 0){
          diffMinutes = 60 + diffMinutes;
          diffHours--;
        }

        if(diffHours < 0){
          diffHours = 24 + diffHours;
          diffDays--;
        }

        if(diffDays < 0){
          diffDays = 31 + diffDays;
          diffMonths--;
        }
        var stringMonth = '';;
        var stringDay = '';;
        var stringHour = '';
        var stringMinute = '';
        var stringSecond = '';

        if(diffMonths > 0)
         stringMonth = diffMonths + ' mesi';

         
        if(diffDays > 0)
         stringDay = ', ' + diffDays + ' giorni';

         
        if(diffHours > 0)
         stringHour = ', ' + diffHours + ' ore';

         
        if(diffMinutes > 0)
         stringMinute = ', ' + diffMinutes + ' minuti';

         
        if(diffSeconds > 0)
         stringSecond = ', ' + diffSeconds + ' secondi ';

         var stringOut = stringMonth+stringDay+stringHour+stringMinute+stringSecond;
        

        return 'Mancano ' + stringOut + ' al nostro matrimonio!'; 

      }
    });
  </script>
</dom-module>
